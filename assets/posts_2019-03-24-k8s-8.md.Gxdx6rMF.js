import{_ as a,c as i,ah as n,o as l}from"./chunks/framework.B8QGmHkS.js";const d=JSON.parse('{"title":"k8s学习笔记(8)——Helm","description":"","frontmatter":{"layout":"post","title":"k8s学习笔记(8)——Helm","date":"2019-03-24 12:30:00 +0800","tags":"k8s"},"headers":[],"relativePath":"posts/2019-03-24-k8s-8.md","filePath":"posts/2019-03-24-k8s-8.md"}'),p={name:"posts/2019-03-24-k8s-8.md"};function e(t,s,h,k,r,E){return l(),i("div",null,s[0]||(s[0]=[n(`<h2 id="一、helm" tabindex="-1">一、Helm <a class="header-anchor" href="#一、helm" aria-label="Permalink to &quot;一、Helm&quot;">​</a></h2><p><a href="https://helm.sh/" target="_blank" rel="noreferrer">Helm</a>是k8s的包管理工具。简单举例来说，假如要部署一个MySQL，需要部署Service，Secret，PV，Deployment等多个对象，需要写在一个或多个yaml文件中。在现实的场景中，有非常多的应用需要部署，如果每次都是写这样一堆的yaml文件就会非常麻烦，同时也无法支持复用和配置化管理。</p><p>Helm主要有两个概念：chart和release。</p><ul><li>chart是一个信息集合，可用来创建一系列的k8s的资源，可类比于apt的软件安装包。一个chart中包含了一系列的yaml模板文件，以及描述文件和配置文件。</li><li>release是chart的运行实例。当chart被安装到k8s集群，就会生成一个release实例。</li></ul><p>Helm包含两个组件：Helm客户端和Tiller服务器。</p><ul><li>Helm客户端是一个命令行工具，用来与Tiller服务器交互，从而管理chart和release</li><li>Tiller服务器安装在k8s集群内，用来接收Helm客户端的信息，安装chart，更新或卸载release</li></ul><h2 id="二、安装" tabindex="-1">二、安装 <a class="header-anchor" href="#二、安装" aria-label="Permalink to &quot;二、安装&quot;">​</a></h2><p>参考<a href="https://helm.sh/docs/using_helm/#installing-helm" target="_blank" rel="noreferrer">Installing Helm</a></p><p>安装完成后执行 <code>helm init</code> 即可安装tiller。</p><h2 id="三、chart" tabindex="-1">三、Chart <a class="header-anchor" href="#三、chart" aria-label="Permalink to &quot;三、Chart&quot;">​</a></h2><p>通过<code>helm fetch stable/mysql</code>可以获取到mysql的chart包，然后解压，可以看到目录结构如下：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>mysql</span></span>
<span class="line"><span>├── Chart.yaml</span></span>
<span class="line"><span>├── README.md</span></span>
<span class="line"><span>├── templates</span></span>
<span class="line"><span>│   ├── NOTES.txt</span></span>
<span class="line"><span>│   ├── _helpers.tpl</span></span>
<span class="line"><span>│   ├── configurationFiles-configmap.yaml</span></span>
<span class="line"><span>│   ├── deployment.yaml</span></span>
<span class="line"><span>│   ├── initializationFiles-configmap.yaml</span></span>
<span class="line"><span>│   ├── pvc.yaml</span></span>
<span class="line"><span>│   ├── secrets.yaml</span></span>
<span class="line"><span>│   ├── svc.yaml</span></span>
<span class="line"><span>│   └── tests</span></span>
<span class="line"><span>│       ├── test-configmap.yaml</span></span>
<span class="line"><span>│       └── test.yaml</span></span>
<span class="line"><span>└── values.yaml</span></span></code></pre></div><p>其中Chart.yaml是对该chart的描述，该文件是必需的，内容如下：</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">appVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.7.14</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Fast, reliable, scalable, and easy to use open-source relational database system.</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">engine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">gotpl</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">home</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://www.mysql.com/</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">icon</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://www.mysql.com/common/logos/logo-mysql-170x115.png</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">keywords</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mysql</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">database</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">sql</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">maintainers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">email</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">o.with@sportradar.com</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">olemarkus</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">email</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">viglesias@google.com</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">viglesiasce</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mysql</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">sources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://github.com/kubernetes/charts</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://github.com/docker-library/mysql</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.15.0</span></span></code></pre></div><p>values.yaml是该chart的配置信息，包含了一些列的配置型和默认值。</p><p>templates目录是k8s资源的模板文件，通常来说包含Deployment，Service等模板。</p><p>Helm会将values.yaml中的配置注入到templates目录下的模板文件中，生成标准的yaml配置。</p><p>Helm使用的是Golang的模板语言。</p>`,18)]))}const o=a(p,[["render",e]]);export{d as __pageData,o as default};
