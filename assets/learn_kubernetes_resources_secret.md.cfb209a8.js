import{_ as s,o as a,c as n,a as l}from"./app.9c5b3fde.js";const F=JSON.parse('{"title":"Secret","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u7C7B\u578B","slug":"\u7C7B\u578B","link":"#\u7C7B\u578B","children":[]},{"level":2,"title":"\u521B\u5EFA Generic Secret","slug":"\u521B\u5EFA-generic-secret","link":"#\u521B\u5EFA-generic-secret","children":[{"level":3,"title":"From literal","slug":"from-literal","link":"#from-literal","children":[]},{"level":3,"title":"From file","slug":"from-file","link":"#from-file","children":[]},{"level":3,"title":"From directory","slug":"from-directory","link":"#from-directory","children":[]},{"level":3,"title":"From env file","slug":"from-env-file","link":"#from-env-file","children":[]},{"level":3,"title":"From YAML","slug":"from-yaml","link":"#from-yaml","children":[]}]},{"level":2,"title":"\u521B\u5EFA Docker Registry Secret","slug":"\u521B\u5EFA-docker-registry-secret","link":"#\u521B\u5EFA-docker-registry-secret","children":[]},{"level":2,"title":"\u521B\u5EFA TLS Secret","slug":"\u521B\u5EFA-tls-secret","link":"#\u521B\u5EFA-tls-secret","children":[]},{"level":2,"title":"\u4F7F\u7528 Secret","slug":"\u4F7F\u7528-secret","link":"#\u4F7F\u7528-secret","children":[{"level":3,"title":"\u4F5C\u4E3A\u73AF\u5883\u53D8\u91CF","slug":"\u4F5C\u4E3A\u73AF\u5883\u53D8\u91CF","link":"#\u4F5C\u4E3A\u73AF\u5883\u53D8\u91CF","children":[]},{"level":3,"title":"\u4F5C\u4E3A Volume","slug":"\u4F5C\u4E3A-volume","link":"#\u4F5C\u4E3A-volume","children":[]},{"level":3,"title":"\u4F7F\u7528 Docker Registry Secret","slug":"\u4F7F\u7528-docker-registry-secret","link":"#\u4F7F\u7528-docker-registry-secret","children":[]}]},{"level":2,"title":"\u53C2\u8003","slug":"\u53C2\u8003","link":"#\u53C2\u8003","children":[]}],"relativePath":"learn/kubernetes/resources/secret.md"}'),p={name:"learn/kubernetes/resources/secret.md"},e=l(`<h1 id="secret" tabindex="-1">Secret <a class="header-anchor" href="#secret" aria-hidden="true">#</a></h1><h2 id="\u7C7B\u578B" tabindex="-1">\u7C7B\u578B <a class="header-anchor" href="#\u7C7B\u578B" aria-hidden="true">#</a></h2><p>\u6267\u884C <code>kubectl create secret -h</code>\uFF0C\u53EF\u4EE5\u770B\u5230\uFF1A</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">Create a secret using specified subcommand.</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">Available Commands:</span></span>
<span class="line"><span style="color:#A6ACCD;">  docker-registry Create a secret for use with a Docker registry</span></span>
<span class="line"><span style="color:#A6ACCD;">  generic         Create a secret from a local file, directory or literal value</span></span>
<span class="line"><span style="color:#A6ACCD;">  tls             Create a TLS secret</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">Usage:</span></span>
<span class="line"><span style="color:#A6ACCD;">  kubectl create secret [flags] [options]</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u53EF\u4EE5\u901A\u8FC7\u5982\u4E0B flag \u53BB\u521B\u5EFA Secret\uFF1A</p><ul><li>generic\uFF1A\u521B\u5EFA\u51FA\u6765\u7684 Secret \u7C7B\u578B\u4E3A <code>Opaque</code></li><li>docker-registry\uFF1A\u521B\u5EFA\u51FA\u6765\u7684 Secret \u7C7B\u578B\u4E3A <code>kubernetes.io/dockerconfigjson</code></li><li>tls\uFF1A\u521B\u5EFA\u51FA\u6765\u7684 Secret \u7C7B\u578B\u4E3A <code>kubernetes.io/tls</code></li></ul><p>\u9664\u4E86\u4EE5\u4E0A\u4E09\u79CD\u7C7B\u578B\u5916\uFF0C\u8FD8\u6709 <code>kubernetes.io/service-account-token</code> \u7C7B\u578B\u7684 Secret\uFF0C\u53EF\u4EE5\u53C2\u8003 <a href="./service-account.html">ServiceAccount</a></p><h2 id="\u521B\u5EFA-generic-secret" tabindex="-1">\u521B\u5EFA Generic Secret <a class="header-anchor" href="#\u521B\u5EFA-generic-secret" aria-hidden="true">#</a></h2><h3 id="from-literal" tabindex="-1">From literal <a class="header-anchor" href="#from-literal" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">$ kubectl create secret generic userauth \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    --from-literal=username=admin \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    --from-literal=password=admin</span></span>
<span class="line"></span></code></pre></div><h3 id="from-file" tabindex="-1">From file <a class="header-anchor" href="#from-file" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> -n admin </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> tee username</span></span>
<span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> -n admin </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> tee password</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">$ kubectl create secret generic userauth \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    --from-file=username \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    --from-file=password</span></span>
<span class="line"></span></code></pre></div><h3 id="from-directory" tabindex="-1">From directory <a class="header-anchor" href="#from-directory" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> -n admin </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> tee auth/username</span></span>
<span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> -n admin </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> tee auth/password</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">$ kubectl create secret generic userauth --from-file=auth/</span></span>
<span class="line"></span></code></pre></div><h3 id="from-env-file" tabindex="-1">From env file <a class="header-anchor" href="#from-env-file" aria-hidden="true">#</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">username=admin\\npassword=admin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> tee auth.env</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">$ kubectl create secret generic userauth --from-env-file=auth.env</span></span>
<span class="line"></span></code></pre></div><h3 id="from-yaml" tabindex="-1">From YAML <a class="header-anchor" href="#from-yaml" aria-hidden="true">#</a></h3><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki"><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">v1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Secret</span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">userauth</span></span>
<span class="line"><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Opaque</span></span>
<span class="line"><span style="color:#F07178;">data</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">username</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">YWRtaW4=</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">password</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">YWRtaW4=</span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">$ kubectl apply -f userauth.yaml</span></span>
<span class="line"></span></code></pre></div><h2 id="\u521B\u5EFA-docker-registry-secret" tabindex="-1">\u521B\u5EFA Docker Registry Secret <a class="header-anchor" href="#\u521B\u5EFA-docker-registry-secret" aria-hidden="true">#</a></h2><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">$ kubectl create secret docker-registry private-registry \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    --docker-username=admin \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    --docker-password=admin \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    --docker-email=admin@example.com \\</span></span>
<span class="line"><span style="color:#A6ACCD;">    --docker-server=https://127.0.0.1:5000</span></span>
<span class="line"></span></code></pre></div><p>\u7136\u540E\u901A\u8FC7 <code>kubectl get secret private-registry -oyaml</code> \u67E5\u770B\uFF1A</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki"><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">v1</span></span>
<span class="line"><span style="color:#F07178;">data</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">.dockerconfigjson</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">eyJhdXRocyI6eyJodHRwczovLzEyNy4wLjAuMTo1MDAwIjp7InVzZXJuYW1lIjoiYWRtaW4iLCJwYXNzd29yZCI6ImFkbWluIiwiZW1haWwiOiJhZG1pbkBleGFtcGxlLmNvbSIsImF1dGgiOiJZV1J0YVc0NllXUnRhVzQ9In19fQ==</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Secret</span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">creationTimestamp</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> 2019-08-11T10:03:47Z</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">private-registry</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">namespace</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">default</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">resourceVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">571738</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">selfLink</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/api/v1/namespaces/default/secrets/private-registry</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">uid</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">4fb6a863-bc1f-11e9-98fc-025000000001</span></span>
<span class="line"><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kubernetes.io/dockerconfigjson</span></span>
<span class="line"></span></code></pre></div><p>\u5176\u4E2D <code>.dockerconfigjson</code> \u5B58\u653E\u7684\u5185\u5BB9\u5982\u4E0B\uFF1A</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> eyJhdXRocyI6eyJodHRwczovLzEyNy4wLjAuMTo1MDAwIjp7InVzZXJuYW1lIjoiYWRtaW4iLCJwYXNzd29yZCI6ImFkbWluIiwiZW1haWwiOiJhZG1pbkBleGFtcGxlLmNvbSIsImF1dGgiOiJZV1J0YVc0NllXUnRhVzQ9In19fQ== </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> base64 -D </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> jq</span></span>
<span class="line"></span></code></pre></div><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">auths</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">https://127.0.0.1:5000</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">username</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">admin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">password</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">admin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">email</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">admin@example.com</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">auth</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">YWRtaW46YWRtaW4=</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><blockquote><p>\u4E5F\u53EF\u4EE5\u901A\u8FC7 <code>.yaml</code> \u6587\u4EF6\u5C06\u5185\u5BB9 base64 \u7F16\u7801\u53BB\u521B\u5EFA Secret</p></blockquote><h2 id="\u521B\u5EFA-tls-secret" tabindex="-1">\u521B\u5EFA TLS Secret <a class="header-anchor" href="#\u521B\u5EFA-tls-secret" aria-hidden="true">#</a></h2><p>\u9996\u5148\u751F\u6210\u81EA\u7B7E\u540D\u8BC1\u4E66\uFF1A</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;"># genrate private key</span></span>
<span class="line"><span style="color:#A6ACCD;">$ openssl genrsa -out server.key 2048</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># generate certificate signing request</span></span>
<span class="line"><span style="color:#A6ACCD;">$ openssl req -new -sha256 -key server.key -out server.csr</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;"># generate self-signed certificate</span></span>
<span class="line"><span style="color:#A6ACCD;">$ openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt</span></span>
<span class="line"></span></code></pre></div><p>\u7136\u540E\u6267\u884C\uFF1A</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">$ kubectl create secret tls tls-secret --cert=server.cert --key=server.key</span></span>
<span class="line"></span></code></pre></div><p>\u901A\u8FC7 <code>kubectl get secret tls-secret -oyaml</code> \u67E5\u770B\u5185\u5BB9\uFF1A</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">apiVersion: v1</span></span>
<span class="line"><span style="color:#A6ACCD;">data:</span></span>
<span class="line"><span style="color:#A6ACCD;">  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0...</span></span>
<span class="line"><span style="color:#A6ACCD;">  tls.key: LS0tLS1CRUdJTiBSU0EgUFJJVk...</span></span>
<span class="line"><span style="color:#A6ACCD;">kind: Secret</span></span>
<span class="line"><span style="color:#A6ACCD;">metadata:</span></span>
<span class="line"><span style="color:#A6ACCD;">  creationTimestamp: 2019-08-11T10:17:07Z</span></span>
<span class="line"><span style="color:#A6ACCD;">  name: tls-secret</span></span>
<span class="line"><span style="color:#A6ACCD;">  namespace: default</span></span>
<span class="line"><span style="color:#A6ACCD;">  resourceVersion: &quot;572616&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  selfLink: /api/v1/namespaces/default/secrets/tls-secret</span></span>
<span class="line"><span style="color:#A6ACCD;">  uid: 2c35e338-bc21-11e9-98fc-025000000001</span></span>
<span class="line"><span style="color:#A6ACCD;">type: kubernetes.io/tls</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><blockquote><p>\u4E5F\u53EF\u4EE5\u901A\u8FC7 <code>.yaml</code> \u6587\u4EF6\u5C06 crt \u548C key \u505A base64 \u7F16\u7801\u53BB\u521B\u5EFA Secret</p></blockquote><h2 id="\u4F7F\u7528-secret" tabindex="-1">\u4F7F\u7528 Secret <a class="header-anchor" href="#\u4F7F\u7528-secret" aria-hidden="true">#</a></h2><p>Secret \u7684\u4F7F\u7528\u548C <a href="./configmap.html">ConfigMap</a> \u7C7B\u4F3C\uFF0C\u5373\u53EF\u4EE5\u4F5C\u4E3A\u73AF\u5883\u53D8\u91CF\uFF0C\u4E5F\u53EF\u4EE5\u4F5C\u4E3A Volume\u3002</p><h3 id="\u4F5C\u4E3A\u73AF\u5883\u53D8\u91CF" tabindex="-1">\u4F5C\u4E3A\u73AF\u5883\u53D8\u91CF <a class="header-anchor" href="#\u4F5C\u4E3A\u73AF\u5883\u53D8\u91CF" aria-hidden="true">#</a></h3><p>\u53EF\u4EE5\u4F7F\u7528 <code>env</code> \u4ECE Secret \u4E2D\u53D6\u51FA\u7279\u5B9A\u7684\u503C\u4F5C\u4E3A\u73AF\u5883\u53D8\u91CF\uFF1A</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki"><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">v1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Pod</span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">busybox</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">busybox</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">busybox:1.31.0</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">command</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/bin/sh</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-c</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">echo $USERNAME:$PASSWORD</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">env</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">USERNAME</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">valueFrom</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">secretKeyRef</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">userauth</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">username</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">PASSWORD</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">valueFrom</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">secretKeyRef</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">userauth</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">password</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">restartPolicy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Never</span></span>
<span class="line"></span></code></pre></div><p>\u4E5F\u53EF\u4EE5\u4F7F\u7528 <code>envFrom</code> \u4F7F\u7528\u6574\u4E2A Secret \u4F5C\u4E3A\u73AF\u5883\u53D8\u91CF\uFF1A</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki"><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">v1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Secret</span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">userauth</span></span>
<span class="line"><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Opaque</span></span>
<span class="line"><span style="color:#F07178;">data</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">USERNAME</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">YWRtaW4=</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">PASSWORD</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">YWRtaW4=</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">v1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Pod</span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">busybox</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">busybox</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">busybox:1.31.0</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">command</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/bin/sh</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-c</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">echo $USERNAME:$PASSWORD</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">envFrom</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">secretRef</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">userauth</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">restartPolicy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Never</span></span>
<span class="line"></span></code></pre></div><h3 id="\u4F5C\u4E3A-volume" tabindex="-1">\u4F5C\u4E3A Volume <a class="header-anchor" href="#\u4F5C\u4E3A-volume" aria-hidden="true">#</a></h3><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki"><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">v1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Pod</span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">busybox</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">busybox</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">busybox:1.31.0</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">command</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/bin/sh</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-c</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">echo $(cat /app/auth/username):$(cat /app/auth/password)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">volumeMounts</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">userauth</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">mountPath</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/app/auth</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">volumes</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">userauth</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">secret</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">secretName</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">userauth</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">restartPolicy</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Never</span></span>
<span class="line"></span></code></pre></div><h3 id="\u4F7F\u7528-docker-registry-secret" tabindex="-1">\u4F7F\u7528 Docker Registry Secret <a class="header-anchor" href="#\u4F7F\u7528-docker-registry-secret" aria-hidden="true">#</a></h3><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki"><code><span class="line"><span style="color:#F07178;">apiVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">v1</span></span>
<span class="line"><span style="color:#F07178;">kind</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Pod</span></span>
<span class="line"><span style="color:#F07178;">metadata</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">private-reg</span></span>
<span class="line"><span style="color:#F07178;">spec</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">containers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">private-reg-container</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">private-image</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">imagePullSecrets</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">private-registry</span></span>
<span class="line"></span></code></pre></div><h2 id="\u53C2\u8003" tabindex="-1">\u53C2\u8003 <a class="header-anchor" href="#\u53C2\u8003" aria-hidden="true">#</a></h2><ul><li><a href="https://kubernetes.io/docs/concepts/configuration/secret/" target="_blank" rel="noreferrer">Secrets</a></li></ul>`,48),o=[e];function c(t,r,y,D,i,C){return a(),n("div",null,o)}const d=s(p,[["render",c]]);export{F as __pageData,d as default};
