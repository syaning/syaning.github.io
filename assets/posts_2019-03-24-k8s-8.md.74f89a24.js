import{_ as s,o as a,c as l,V as n}from"./chunks/framework.16eef3c0.js";const A=JSON.parse('{"title":"k8s学习笔记(8)——Helm","description":"","frontmatter":{"layout":"post","title":"k8s学习笔记(8)——Helm","date":"2019-03-24 12:30:00 +0800"},"headers":[],"relativePath":"posts/2019-03-24-k8s-8.md"}'),p={name:"posts/2019-03-24-k8s-8.md"},e=n(`<h2 id="一、helm" tabindex="-1">一、Helm <a class="header-anchor" href="#一、helm" aria-label="Permalink to &quot;一、Helm&quot;">​</a></h2><p><a href="https://helm.sh/" target="_blank" rel="noreferrer">Helm</a>是k8s的包管理工具。简单举例来说，假如要部署一个MySQL，需要部署Service，Secret，PV，Deployment等多个对象，需要写在一个或多个yaml文件中。在现实的场景中，有非常多的应用需要部署，如果每次都是写这样一堆的yaml文件就会非常麻烦，同时也无法支持复用和配置化管理。</p><p>Helm主要有两个概念：chart和release。</p><ul><li>chart是一个信息集合，可用来创建一系列的k8s的资源，可类比于apt的软件安装包。一个chart中包含了一系列的yaml模板文件，以及描述文件和配置文件。</li><li>release是chart的运行实例。当chart被安装到k8s集群，就会生成一个release实例。</li></ul><p>Helm包含两个组件：Helm客户端和Tiller服务器。</p><ul><li>Helm客户端是一个命令行工具，用来与Tiller服务器交互，从而管理chart和release</li><li>Tiller服务器安装在k8s集群内，用来接收Helm客户端的信息，安装chart，更新或卸载release</li></ul><h2 id="二、安装" tabindex="-1">二、安装 <a class="header-anchor" href="#二、安装" aria-label="Permalink to &quot;二、安装&quot;">​</a></h2><p>参考<a href="https://helm.sh/docs/using_helm/#installing-helm" target="_blank" rel="noreferrer">Installing Helm</a></p><p>安装完成后执行 <code>helm init</code> 即可安装tiller。</p><h2 id="三、chart" tabindex="-1">三、Chart <a class="header-anchor" href="#三、chart" aria-label="Permalink to &quot;三、Chart&quot;">​</a></h2><p>通过<code>helm fetch stable/mysql</code>可以获取到mysql的chart包，然后解压，可以看到目录结构如下：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">mysql</span></span>
<span class="line"><span style="color:#A6ACCD;">├── Chart.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">├── README.md</span></span>
<span class="line"><span style="color:#A6ACCD;">├── templates</span></span>
<span class="line"><span style="color:#A6ACCD;">│   ├── NOTES.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">│   ├── _helpers.tpl</span></span>
<span class="line"><span style="color:#A6ACCD;">│   ├── configurationFiles-configmap.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">│   ├── deployment.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">│   ├── initializationFiles-configmap.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">│   ├── pvc.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">│   ├── secrets.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">│   ├── svc.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">│   └── tests</span></span>
<span class="line"><span style="color:#A6ACCD;">│       ├── test-configmap.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">│       └── test.yaml</span></span>
<span class="line"><span style="color:#A6ACCD;">└── values.yaml</span></span></code></pre></div><p>其中Chart.yaml是对该chart的描述，该文件是必需的，内容如下：</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F07178;">appVersion</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5.7.14</span></span>
<span class="line"><span style="color:#F07178;">description</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Fast, reliable, scalable, and easy to use open-source relational database system.</span></span>
<span class="line"><span style="color:#F07178;">engine</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">gotpl</span></span>
<span class="line"><span style="color:#F07178;">home</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://www.mysql.com/</span></span>
<span class="line"><span style="color:#F07178;">icon</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://www.mysql.com/common/logos/logo-mysql-170x115.png</span></span>
<span class="line"><span style="color:#F07178;">keywords</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mysql</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">database</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">sql</span></span>
<span class="line"><span style="color:#F07178;">maintainers</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">email</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">o.with@sportradar.com</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">olemarkus</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">email</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">viglesias@google.com</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">viglesiasce</span></span>
<span class="line"><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mysql</span></span>
<span class="line"><span style="color:#F07178;">sources</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://github.com/kubernetes/charts</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://github.com/docker-library/mysql</span></span>
<span class="line"><span style="color:#F07178;">version</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0.15.0</span></span></code></pre></div><p>values.yaml是该chart的配置信息，包含了一些列的配置型和默认值。</p><p>templates目录是k8s资源的模板文件，通常来说包含Deployment，Service等模板。</p><p>Helm会将values.yaml中的配置注入到templates目录下的模板文件中，生成标准的yaml配置。</p><p>Helm使用的是Golang的模板语言。</p>`,18),o=[e];function t(c,r,y,i,C,D){return a(),l("div",null,o)}const h=s(p,[["render",t]]);export{A as __pageData,h as default};
